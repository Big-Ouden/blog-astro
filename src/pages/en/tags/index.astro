---
import { getCollection } from 'astro:content';
import BaseLayout from '@layouts/BaseLayout.astro';

import { getLangFromUrl, useTranslations,useTranslatedPath  } from '@i18n/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const translatePath = useTranslatedPath(lang);

// Filter posts by language
const allPosts = await getCollection("blog", ({ id }) => {
    return id.startsWith(`${lang}/`) || id.includes(`-${lang}.md`) || id.includes(`-${lang}/`);
});
const tags = [...new Set(allPosts.map((post: any) => post.data.tags).flat())];




const pageTitle = "Tags index";
---


<BaseLayout>
    <div class= "flex flex-col justify-between space-y-10 mb-5">
    
        <h1 class="text-3xl">{pageTitle}<span class="text-info">.</span></h1>
    </div>
    <div class="flex flex-row flex-wrap space-x-5 bg-primary">
        {tags.map((tag) => 
        <a  href={ translatePath(`/tags/`)+tag}>
                <p>{tag}</p>
            </a>
        )}
    </div>
</BaseLayout>
